import { useAppSelector } from '@hooks/storeHooks';
import { Container, Title } from './styles';
import { Skeleton } from '../TotalPriceCencosud/styles';
import { formattedCLP } from '@utils/helpers';
import Image from 'next/image';
import calculateTotalWithoutShippingPrice from '@utils/calculateTotalWithoutShippingPrice';
import { PriceType, Totals } from '@entities/cart/cart.entity';

interface Props {
  className?: string;
}

const TotalCencopayPrice = (props: Props) => {
  const { className } = props;
  const { cartBFF, loading, isCencopayActive } = useAppSelector(
    (state) => state.cart,
  );

  if (!cartBFF?.totals?.totalCencoPay || !isCencopayActive) return null;

  const valueWithoutShipping = calculateTotalWithoutShippingPrice(
    cartBFF?.totals as Totals,
    PriceType.totalCencoPay,
  );
  const value = formattedCLP(valueWithoutShipping);

  return (
    <Container className={`${className}`}>
      <div className={`cencopay-total-container`}>
        <Title className="title">Subtotal con CencoPay</Title>
        <svg
          width="30"
          height="21"
          viewBox="0 0 24 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M24 14.3979L24 1.60502C24 0.720749 23.2832 0.00390622 22.3989 0.00390618L1.60042 0.00390527C0.716148 0.00390523 -0.000694306 0.720749 -0.000694345 1.60502L-0.000694904 14.3979C-0.000694943 15.2822 0.716151 15.999 1.60042 15.999L22.3989 15.999C23.2832 15.999 24 15.2822 24 14.3979Z"
            fill="#0500C4"
          />
          <path
            d="M4.97905 4.18012C5.06362 4.09555 5.15172 4.0286 5.25743 4.00745C5.45125 3.92288 5.6662 3.92288 5.88116 4.00745C5.9904 4.04974 6.07497 4.11669 6.15955 4.18012L6.41679 4.43737L6.91366 3.91935L6.65642 3.66211C6.50489 3.51058 6.33222 3.40487 6.1384 3.31677C5.77192 3.16524 5.36315 3.16524 4.97552 3.31677C4.78171 3.3802 4.60904 3.51058 4.45751 3.66211C4.30598 3.81364 4.20027 3.98631 4.11217 4.18012C4.04874 4.37394 4.00293 4.56775 4.00293 4.76156C4.00293 4.95538 4.04522 5.14919 4.11217 5.343C4.1756 5.53682 4.30598 5.70949 4.45751 5.86101C4.60904 6.01254 4.78171 6.11826 4.97552 6.20636C5.16934 6.26979 5.36315 6.3156 5.55696 6.3156C5.75078 6.3156 5.94459 6.27331 6.1384 6.20636C6.33222 6.12178 6.50489 6.01254 6.65642 5.86101L6.91366 5.60377L6.41679 5.08576L6.15955 5.343C6.07497 5.42758 5.98688 5.49453 5.9023 5.51567C5.79306 5.55796 5.68735 5.5791 5.57811 5.5791C5.34201 5.5791 5.16934 5.49453 4.99667 5.343C4.91209 5.25843 4.84514 5.17033 4.82399 5.06462C4.78171 4.95538 4.76056 4.84966 4.76056 4.76156C4.76056 4.65232 4.78171 4.54661 4.82399 4.45851C4.84866 4.35279 4.91209 4.2647 4.97905 4.18012Z"
            fill="white"
          />
          <path
            d="M9.71403 3.66211C9.56251 3.51058 9.38984 3.40487 9.19602 3.31677C8.82954 3.16524 8.42077 3.16524 8.03314 3.31677C7.83933 3.3802 7.66665 3.51058 7.51513 3.66211C7.3636 3.81364 7.25788 3.98631 7.16979 4.18012C7.10636 4.37394 7.06055 4.56775 7.06055 4.76156C7.06055 4.95538 7.10283 5.14919 7.16979 5.343C7.23674 5.53682 7.3636 5.70949 7.51513 5.86101C7.66665 6.01254 7.83933 6.11826 8.012 6.20636C8.20581 6.29093 8.39962 6.3156 8.59344 6.3156C8.78725 6.3156 9.00221 6.27331 9.17488 6.20636C9.36869 6.12178 9.52022 6.01254 9.67175 5.86101L9.92899 5.60377L9.41098 5.08576L9.15373 5.343C9.02335 5.47339 8.87535 5.55796 8.70268 5.5791C8.66039 5.5791 8.6181 5.5791 8.57229 5.5791C8.48772 5.5791 8.37848 5.55796 8.29391 5.53682L9.90785 3.92288L9.71403 3.66211ZM8.6181 3.94402C8.70268 3.94402 8.81192 3.96517 8.89649 3.98631C8.8542 4.0286 8.78725 4.09555 8.70268 4.18012L7.84285 5.03995C7.82171 4.95538 7.80056 4.86728 7.80056 4.78271C7.80056 4.54661 7.88514 4.37394 8.03666 4.20127C8.16705 4.07088 8.31505 3.98631 8.48772 3.96516C8.53001 3.94402 8.57229 3.94402 8.6181 3.94402Z"
            fill="white"
          />
          <path
            d="M12.7743 3.66464C12.6228 3.51311 12.4712 3.40739 12.2774 3.34044C11.9109 3.16777 11.4599 3.16777 11.0934 3.34044C10.8996 3.42501 10.7481 3.53425 10.5965 3.66464C10.4661 3.79502 10.3604 3.96769 10.2723 4.16151C10.1878 4.33418 10.1631 4.54913 10.1631 4.76409V6.29346H10.8749V4.76409C10.8749 4.65485 10.8961 4.54913 10.9383 4.43989C10.9806 4.33065 11.0476 4.24608 11.111 4.18265C11.1956 4.09808 11.2837 4.05227 11.3683 4.00998C11.5621 3.92541 11.7982 3.92541 12.0131 4.00998C12.1224 4.05227 12.2069 4.11922 12.2704 4.18265C12.3338 4.24608 12.4008 4.33418 12.443 4.43989C12.4853 4.52447 12.5065 4.63371 12.5065 4.74295V6.27231H13.2183V4.74295C13.2183 4.52799 13.176 4.33418 13.0879 4.14036C13.0315 3.96769 12.9258 3.81616 12.7743 3.66464Z"
            fill="white"
          />
          <path
            d="M14.3882 4.18012C14.4728 4.09555 14.5609 4.0286 14.6666 4.00745C14.8604 3.92288 15.0754 3.92288 15.2903 4.00745C15.3996 4.04974 15.4842 4.11669 15.5687 4.18012L15.826 4.43737L16.3228 3.91935L16.0656 3.66211C15.9141 3.51058 15.7414 3.40487 15.5476 3.31677C15.1811 3.16524 14.7723 3.16524 14.3847 3.31677C14.1909 3.3802 14.0182 3.51058 13.8667 3.66211C13.7152 3.81364 13.6094 3.98631 13.5213 4.18012C13.4579 4.37394 13.4121 4.56775 13.4121 4.76156C13.4121 4.95538 13.4544 5.14919 13.5213 5.343C13.5883 5.53682 13.7152 5.70949 13.8667 5.86101C14.0182 6.01254 14.1909 6.11826 14.3847 6.20636C14.5785 6.26979 14.7723 6.3156 14.9661 6.3156C15.16 6.3156 15.3538 6.27331 15.5476 6.20636C15.7414 6.12178 15.9141 6.01254 16.0656 5.86101L16.3228 5.60377L15.826 5.08576L15.5687 5.343C15.4842 5.42758 15.3961 5.49453 15.3115 5.51567C15.2022 5.55796 15.0965 5.5791 14.9873 5.5791C14.7512 5.5791 14.5785 5.49453 14.4058 5.343C14.3213 5.25843 14.2543 5.17033 14.2332 5.06462C14.1909 4.95538 14.1697 4.84966 14.1697 4.76156C14.1697 4.65232 14.1909 4.54661 14.2332 4.45851C14.2614 4.35279 14.3037 4.2647 14.3882 4.18012Z"
            fill="white"
          />
          <path
            d="M19.1288 3.66464C18.9773 3.51311 18.8257 3.40739 18.6319 3.34044C18.2654 3.16777 17.8144 3.16777 17.4479 3.34044C17.2541 3.42501 17.1025 3.53425 16.951 3.66464C16.8206 3.79502 16.7149 3.96769 16.6268 4.1615C16.5422 4.33418 16.5176 4.54913 16.5176 4.76409C16.5176 4.97905 16.5599 5.17286 16.6268 5.36667C16.7114 5.56049 16.8206 5.71201 16.951 5.86354C17.1025 6.01507 17.2541 6.12079 17.4479 6.20888C17.6417 6.29346 17.8355 6.31812 18.0505 6.31812C18.2654 6.31812 18.4592 6.27584 18.6531 6.20888C18.8469 6.12431 18.9984 6.01507 19.1499 5.86354C19.3014 5.71201 19.4072 5.56049 19.4741 5.36667C19.5587 5.17286 19.6045 4.97905 19.6045 4.76409C19.6045 4.54913 19.5622 4.35532 19.4741 4.1615C19.3649 3.96769 19.2556 3.81616 19.1288 3.66464ZM18.8469 4.76409C18.8469 4.87333 18.8257 4.97905 18.7834 5.08829C18.7411 5.19753 18.6742 5.2821 18.6108 5.34553C18.5473 5.40896 18.4592 5.47591 18.3535 5.5182C18.1597 5.60277 17.9025 5.60277 17.7087 5.5182C17.5994 5.47591 17.5148 5.40896 17.4514 5.34553C17.388 5.26096 17.321 5.17286 17.2787 5.08829C17.2365 4.97905 17.2153 4.87333 17.2153 4.76409C17.2153 4.65485 17.2365 4.54913 17.2787 4.43989C17.321 4.33065 17.388 4.24608 17.4514 4.18265C17.536 4.09808 17.6241 4.05226 17.7087 4.00998C17.8179 3.96769 17.9236 3.94655 18.0328 3.94655C18.1421 3.94655 18.2478 3.96769 18.357 4.00998C18.4663 4.05226 18.5509 4.11922 18.6143 4.18265C18.6989 4.24608 18.7447 4.33418 18.787 4.43989C18.8292 4.54561 18.8469 4.63371 18.8469 4.76409Z"
            fill="white"
          />
          <path
            d="M14.0424 9.32835V7.08716H13.0311V7.39022C12.6435 7.13297 12.1924 6.98145 11.6955 6.98145C10.4023 6.98145 9.34863 8.03509 9.34863 9.32835C9.34863 10.6216 10.4023 11.6753 11.6955 11.6753C12.1924 11.6753 12.6435 11.5237 13.0311 11.2665V11.5695H14.0424V9.32835ZM11.7167 10.6604C10.9837 10.6604 10.3811 10.0578 10.3811 9.32483C10.3811 8.59186 10.9837 7.98928 11.7167 7.98928C12.4497 7.98928 13.0522 8.59186 13.0522 9.32483C13.0311 10.0578 12.4497 10.6604 11.7167 10.6604Z"
            fill="#FFAC2C"
          />
          <path
            d="M18.3075 7.08398V9.00098V9.32518C18.3075 10.0581 17.7049 10.6607 16.9719 10.6607C16.2389 10.6607 15.6364 10.0581 15.6364 9.32518V7.08398H14.625V9.32518C14.625 10.1216 15.0338 10.8334 15.6364 11.2422C16.024 11.4994 16.475 11.6509 16.9719 11.6509C17.4688 11.6509 17.9198 11.4994 18.3075 11.2422C18.3075 11.9751 17.7049 12.5566 16.9719 12.5566H16.5209V13.5679H16.9719C17.4688 13.5679 17.9198 13.4164 18.3075 13.1592C18.91 12.7292 19.3188 12.0386 19.3188 11.2422V9.32518V9.00098V7.08398H18.3075Z"
            fill="#00C7F9"
          />
          <path
            d="M6.63533 6.97754C5.43017 6.97754 4.41881 7.90432 4.30957 9.08835V13.5461H5.32093V11.2414C5.70855 11.4987 6.15961 11.6502 6.65648 11.6502C7.94974 11.6502 9.00339 10.5966 9.00339 9.3033C8.9611 8.0347 7.9286 6.97754 6.63533 6.97754ZM6.63533 10.66C5.90237 10.66 5.29978 10.0574 5.29978 9.32445C5.29978 8.59148 5.90237 7.98889 6.63533 7.98889C7.3683 7.98889 7.97089 8.59148 7.97089 9.32445C7.94974 10.0574 7.3683 10.66 6.63533 10.66Z"
            fill="#F04B67"
          />
        </svg>
      </div>
      {loading ||
      !cartBFF?.totals?.totalCencoPay ||
      cartBFF?.totals?.totalCencoPay === -1 ? (
        <Skeleton />
      ) : (
        <span className="value-price">{value}</span>
      )}
    </Container>
  );
};

export default TotalCencopayPrice;
